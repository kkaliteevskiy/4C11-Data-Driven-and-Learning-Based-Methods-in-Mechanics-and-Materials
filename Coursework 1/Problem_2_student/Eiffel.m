% Eiffel Tower Structure
% Random Loading Curve

% Coordinates
nodalPositions = [  0.333724,3.56037
0.186366,3.56037
0.441458,3.43482
0.260045,3.40733
0.0801084,3.42951
0.414047,3.28259
0.103045,3.26143
0.245966,3.15992
0.449863,3.12943
0.0774842,3.11151
0.419821,2.95702
0.105689,2.93485
0.418682,2.778
0.102709,2.75199
0.421693,2.59603
0.0977219,2.56659
0.426659,2.41116
0.0918074,2.37868
0.432902,2.22342
0.0852788,2.18826
0.23857,2.12064
0.440107,2.03283
0.0782555,1.99537
0.243246,1.92783
0.448102,1.83943
0.0706994,1.80004
0.248703,1.73231
0.45679,1.64324
0.0624814,1.60233
0.254876,1.53409
0.466129,1.44433
0.0534285,1.40227
0.261762,1.33313
0.476139,1.24272
0.0433295,1.19993
0.270347,1.12776
0.488556,1.03859
0.0319596,0.995366
0.240202,0.878634
0.502941,0.83197
0.019081,0.788651
0.227981,0.669409
0.518363,0.622859
0.00448787,0.580477
0.210445,0.460584
0.534668,0.413771
-0.0117211,0.374359
0.191325,0.253983
0.55183,0.206819
-0.0294031,0.170334
0.348343,0.0854728
0.170601,0.0493928
0.570105,0.00208461
-0.0486725,-0.031525
0.369836,-0.119766
0.147906,-0.153523
0.589985,-0.200325
-0.0700571,-0.231104
0.393687,-0.323742
0.122179,-0.355436
0.612585,-0.400219
-0.0948996,-0.428167
0.422676,-0.528627
0.0896628,-0.55934
0.641489,-0.596997
-0.127978,-0.621807
0.728377,-0.769923
-0.219368,-0.788579
0.519891,-0.834416
-0.010444,-0.838225
0.700328,-0.957168
-0.179548,-0.970579
0.732307,-1.14611
0.438563,-1.16429
0.0848071,-1.16407
-0.211571,-1.15772
0.608903,-1.28517
-0.086571,-1.28772
0.772358,-1.33131
-0.251885,-1.34095
0.0323655,-1.48813
0.492384,-1.49897
0.816187,-1.51312
-0.298731,-1.52025
0.65899,-1.65646
-0.141688,-1.6611
0.869071,-1.68995
-0.349726,-1.69602
0.547846,-1.78843
-0.0272079,-1.79322
0.716712,-1.83428
-0.196461,-1.83702
0.924557,-1.86337
-0.402267,-1.86889
0.806353,-2.01042
0.375569,-2.0386
0.141187,-2.03845
0.59848,-2.03875
-0.285257,-2.01232
-0.0762087,-2.03831
0.975268,-2.0356
1.0926,-2.04126
-0.453933,-2.03899
-0.569488,-2.03815
0.0323442,-2.26416
0.486876,-2.27018
1.10114,-2.23082
0.258222,-2.28194
-0.57947,-2.22215
0.82116,-2.28113
-0.301643,-2.27898
1.1282,-2.42801
-0.603016,-2.41936
0.380578,-2.50863
0.131871,-2.50885
0.623814,-2.56351
-0.110997,-2.56388
1.21643,-2.62163
0.849152,-2.67175
-0.691353,-2.61363
0.256401,-2.70743
-0.33661,-2.67267
0.458537,-2.72969
0.0543006,-2.73004
0.65064,-2.79634
-0.1378,-2.79672
1.04348,-2.82543
-0.531582,-2.83003
1.31004,-2.82383
-0.78644,-2.81702
0.822741,-2.90463
-0.309591,-2.90544
0.967729,-3.04737
1.2005,-3.02804
-0.45209,-3.05059
-0.685046,-3.02684
1.41027,-3.03253
-0.888253,-3.02847
1.07045,-3.22205
-0.558333,-3.22375
1.51573,-3.23862
1.29828,-3.27746
-0.788435,-3.26697
-0.993846,-3.23805
1.11288,-3.42101
-0.611147,-3.41989
1.43093,-3.40728
-0.907966,-3.4138
1.64225,-3.43115
-1.11902,-3.43443
1.14205,-3.62268
-0.621791,-3.62322
1.33167,-3.62029
-0.807446,-3.62305
1.53554,-3.61772
-1.00885,-3.62288
1.73146,-3.61525
-1.20772,-3.6227 ];

% Topology matrix IX(node1,node2,propno),
connectivities = [      103   104     1
   104   109     1
   109   103     1
   102   101     1
   101   107     1
   107   102     1
     1     2     1
     2     4     1
     4     1     1
     7    10     1
    10     8     1
     8     7     1
     6     3     1
     3     4     1
     4     6     1
     9     6     1
     6     8     1
     8     9     1
     3     1     1
     1     4     1
     4     3     1
     2     5     1
     5     4     1
     4     2     1
     5     7     1
     7     4     1
     4     5     1
    11     9     1
     9     8     1
     8    11     1
     7     8     1
     8     4     1
     4     7     1
     8    10     1
    10    12     1
    12     8     1
    94   103     1
   103    99     1
    99    94     1
    13    11     1
    11    12     1
    12    13     1
   101    93     1
    93    95     1
    95   101     1
    88    94     1
    94    92     1
    92    88     1
    15    13     1
    13    14     1
    14    15     1
    93    87     1
    87    91     1
    91    93     1
    12    14     1
    14    13     1
    13    12     1
    84    88     1
    88    86     1
    86    84     1
    87    83     1
    83    85     1
    85    87     1
    17    15     1
    15    16     1
    16    17     1
    80    84     1
    84    81     1
    81    80     1
    14    16     1
    16    15     1
    15    14     1
   154   152     1
   152   146     1
   146   154     1
    68    72     1
    72    70     1
    70    68     1
    83    79     1
    79    82     1
    82    83     1
    76    80     1
    80    78     1
    78    76     1
    19    17     1
    17    18     1
    18    19     1
    16    18     1
    18    17     1
    17    16     1
    71    67     1
    67    69     1
    69    71     1
    79    73     1
    73    77     1
    77    79     1
   151   153     1
   153   145     1
   145   151     1
    72    76     1
    76    75     1
    75    72     1
    66    68     1
    68    70     1
    70    66     1
    18    21     1
    21    19     1
    19    18     1
    22    19     1
    19    21     1
    21    22     1
    73    71     1
    71    74     1
    74    73     1
    20    23     1
    23    21     1
    21    20     1
    20    21     1
    21    18     1
    18    20     1
    67    65     1
    65    69     1
    69    67     1
    25    22     1
    22    24     1
    24    25     1
    23    26     1
    26    24     1
    24    23     1
    23    24     1
    24    21     1
    21    23     1
    21    24     1
    24    22     1
    22    21     1
   155   157     1
   157   149     1
   149   155     1
    28    25     1
    25    27     1
    27    28     1
    62    66     1
    66    64     1
    64    62     1
    26    29     1
    29    27     1
    27    26     1
    26    27     1
    27    24     1
    24    26     1
    24    27     1
    27    25     1
    25    24     1
     6     4     1
     4     8     1
     8     6     1
   109   113     1
   113   111     1
   111   109     1
    58    62     1
    62    60     1
    60    58     1
   158   156     1
   156   150     1
   150   158     1
    65    61     1
    61    63     1
    63    65     1
   112   107     1
   107   110     1
   110   112     1
    31    28     1
    28    30     1
    30    31     1
    29    32     1
    32    30     1
    30    29     1
    54    58     1
    58    56     1
    56    54     1
    61    57     1
    57    59     1
    59    61     1
   156   154     1
   154   148     1
   148   156     1
    34    31     1
    31    33     1
    33    34     1
    32    35     1
    35    33     1
    33    32     1
   133   139     1
   139   134     1
   134   133     1
    50    54     1
    54    52     1
    52    50     1
   146   140     1
   140   143     1
   143   146     1
   140   135     1
   135   136     1
   136   140     1
   132   126     1
   126   122     1
   122   132     1
   125   131     1
   131   119     1
   119   125     1
   123   125     1
   125   116     1
   116   123     1
   124   121     1
   121   115     1
   115   124     1
    57    53     1
    53    55     1
    55    57     1
   135   132     1
   132   128     1
   128   135     1
   131   133     1
   133   127     1
   127   131     1
   126   124     1
   124   117     1
   117   126     1
   121   123     1
   123   114     1
   114   121     1
   139   145     1
   145   142     1
   142   139     1
   153   155     1
   155   147     1
   147   153     1
    29    30     1
    30    27     1
    27    29     1
    27    30     1
    30    28     1
    28    27     1
    37    34     1
    34    36     1
    36    37     1
    47    50     1
    50    48     1
    48    47     1
    35    38     1
    38    36     1
    36    35     1
    99   103     1
   103   111     1
   111    99     1
    94    99     1
    99    92     1
    92    94     1
    92    99     1
    99   100     1
   100    92     1
   100    99     1
    99   111     1
   111   100     1
    53    49     1
    49    51     1
    51    53     1
    44    47     1
    47    45     1
    45    44     1
   101    95     1
    95   110     1
   110   101     1
    95    93     1
    93    91     1
    91    95     1
    95    91     1
    91    98     1
    98    95     1
    95    98     1
    98   110     1
   110    95     1
    38    41     1
    41    39     1
    39    38     1
    40    37     1
    37    39     1
    39    40     1
    49    46     1
    46    48     1
    48    49     1
    88    92     1
    92    86     1
    86    88     1
    86    92     1
    92    90     1
    90    86     1
    86    90     1
    90    81     1
    81    86     1
    90    92     1
    92   100     1
   100    90     1
    41    44     1
    44    42     1
    42    41     1
    43    40     1
    40    42     1
    42    43     1
    46    43     1
    43    45     1
    45    46     1
    91    87     1
    87    85     1
    85    91     1
    91    85     1
    85    89     1
    89    91     1
    89    85     1
    85    82     1
    82    89     1
    91    89     1
    89    98     1
    98    91     1
    84    86     1
    86    81     1
    81    84     1
    85    83     1
    83    82     1
    82    85     1
   118   112     1
   112   119     1
   119   118     1
   113   120     1
   120   122     1
   122   113     1
    70    72     1
    72    75     1
    75    70     1
   155   149     1
   149   147     1
   147   155     1
   147   149     1
   149   141     1
   141   147     1
   147   141     1
   141   142     1
   142   147     1
    76    78     1
    78    75     1
    75    76     1
    75    78     1
    78    81     1
    81    75     1
    81    78     1
    78    80     1
    80    81     1
    97   100     1
   100   105     1
   105    97     1
    71    69     1
    69    74     1
    74    71     1
   150   156     1
   156   148     1
   148   150     1
   150   148     1
   148   144     1
   144   150     1
   144   143     1
   143   138     1
   138   144     1
    77    73     1
    73    74     1
    74    77     1
    77    74     1
    74    82     1
    82    77     1
    79    77     1
    77    82     1
    82    79     1
    32    33     1
    33    30     1
    30    32     1
    30    33     1
    33    31     1
    31    30     1
   103   109     1
   109   111     1
   111   103     1
   129   118     1
   118   127     1
   127   129     1
    98    96     1
    96   106     1
   106    98     1
   120   130     1
   130   128     1
   128   120     1
    64    66     1
    66    70     1
    70    64     1
    62    64     1
    64    60     1
    60    62     1
    60    64     1
    64    63     1
    63    60     1
   111   113     1
   113   122     1
   122   111     1
    58    60     1
    60    56     1
    56    58     1
    56    60     1
    60    59     1
    59    56     1
    65    63     1
    63    69     1
    69    65     1
    63    61     1
    61    59     1
    59    63     1
    63    59     1
    59    60     1
    60    63     1
   110   107     1
   107   101     1
   101   110     1
   112   110     1
   110   119     1
   119   112     1
    54    56     1
    56    52     1
    52    54     1
    52    56     1
    56    55     1
    55    52     1
    55    56     1
    56    59     1
    59    55     1
    55    59     1
    59    57     1
    57    55     1
   141   137     1
   137   142     1
   142   141     1
   134   137     1
   137   129     1
   129   134     1
   134   129     1
   129   127     1
   127   134     1
   148   154     1
   154   146     1
   146   148     1
    34    33     1
    33    36     1
    36    34     1
    36    33     1
    33    35     1
    35    36     1
   133   134     1
   134   127     1
   127   133     1
   134   139     1
   139   142     1
   142   134     1
    50    52     1
    52    48     1
    48    50     1
    48    51     1
    51    49     1
    49    48     1
   143   140     1
   140   136     1
   136   143     1
   146   143     1
   143   148     1
   148   146     1
   148   143     1
   143   144     1
   144   148     1
   136   135     1
   135   128     1
   128   136     1
   125   119     1
   119   116     1
   116   125     1
   126   117     1
   117   122     1
   122   126     1
    96    97     1
    97   108     1
   108    96     1
   132   122     1
   122   128     1
   128   132     1
   123   116     1
   116   114     1
   114   123     1
   121   114     1
   114   115     1
   115   121     1
   119   131     1
   131   127     1
   127   119     1
   117   124     1
   124   115     1
   115   117     1
   142   145     1
   145   153     1
   153   142     1
    55    53     1
    53    51     1
    51    55     1
    55    51     1
    51    52     1
    52    55     1
    52    51     1
    51    48     1
    48    52     1
   138   143     1
   143   136     1
   136   138     1
   138   136     1
   136   130     1
   130   138     1
   130   136     1
   136   128     1
   128   130     1
   153   147     1
   147   142     1
   142   153     1
   142   137     1
   137   134     1
   134   142     1
    37    36     1
    36    39     1
    39    37     1
    47    48     1
    48    45     1
    45    47     1
    45    48     1
    48    46     1
    46    45     1
    44    45     1
    45    42     1
    42    44     1
    42    45     1
    45    43     1
    43    42     1
    39    41     1
    41    42     1
    42    39     1
    39    42     1
    42    40     1
    40    39     1
    38    39     1
    39    36     1
    36    38     1
   119   127     1
   127   118     1
   118   119     1
   115   114     1
   114   108     1
   108   115     1
   117   115     1
   115   105     1
   105   117     1
   114   116     1
   116   106     1
   106   114     1
   116   119     1
   119   110     1
   110   116     1
   122   117     1
   117   111     1
   111   122     1
   128   122     1
   122   120     1
   120   128     1
    97   105     1
   105   108     1
   108    97     1
   108   105     1
   105   115     1
   115   108     1
   105   100     1
   100   111     1
   111   105     1
    98   106     1
   106   110     1
   110    98     1
   106    96     1
    96   108     1
   108   106     1
   106   108     1
   108   114     1
   114   106     1
     8    12     1
    12    11     1
    11     8     1
    64    70     1
    70    69     1
    69    64     1
    69    63     1
    63    64     1
    64    69     1
   106   116     1
   116   110     1
   110   106     1
   117   105     1
   105   111     1
   111   117     1
    70    75     1
    75    69     1
    69    70     1
    74    69     1
    69    75     1
    75    74     1];

% Element property matrix mprop = [ E A]
mprop = [  210e9 1e-2]; % [Pa, m^2 ]

% Prescribed loads mat(node,ldof,force)
ChosenNodes = [1, 3, 6, 9, 11, 13, 15, 17, 19, 22, 25, 28, 31, 34, 37, 40, 43, 46, 49, 53];
ChosenPositions = nodalPositions(ChosenNodes,:);
N_node = length(ChosenNodes);
N_walk = 3;
epsi_max = 2e5;

NeumannBCs = zeros(N_node, 3);
NeumannBCs(:,1) = ChosenNodes.';
NeumannBCs(:,2) = 1;
NeumannBCs(:,3) = GenBoundary(N_walk, epsi_max, linspace(0,1,N_node)).'; % [N]

% Boundary conditions mat(node,ldof,disp)
DirichletBCs = [   158     2  0.0
            158     1  0.0
            157     2  0.0
            156     2  0.0 
            155     2  0.0 
            154     2  0.0 
            153     2  0.0 
            152     2  0.0 
            151     2  0.0  ];


